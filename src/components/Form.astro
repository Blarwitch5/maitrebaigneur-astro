---
import Buttons from "./ui/Buttons.astro";
---

<form action="https://getform.io/f/07ac1ebb-9a09-434c-a1ae-a86c55824ca5" method="POST">
	<fieldset>
		<legend>En quoi pouvons-nous vous aider ?</legend>
		<div class="form-field">
			<label for="choise1" class="card card-swimming">
				<input type="radio" autocomplete="off" name="choise" value="Leçons de natation" id="choise1" class="radio" />
				<span class="sr-only">Leçons de natation à domicile</span>
				<span class="card-title" aria-hidden="true">Leçons de natation à domicile</span>
			</label>
		</div>
		<div class="form-field">
			<label for="choise2" class="card card-aquaversary">
				<input type="radio" autocomplete="off" name="choise" value="Organisation d'un aquaversaire" id="choise2" class="radio" />
				<span class="sr-only">Organisation d'un aquaversaire</span>
				<span class="card-title" aria-hidden="true">Organisation d'un aquaversaire</span>
			</label>
		</div>
		<div class="form-field">
			<label for="choise3" class="card card-events">
				<input type="radio" autocomplete="off" name="choise" value="Sécuriter d'un événement" id="choise3" class="radio" />
				<span class="sr-only">Sécuriser un événement</span>
				<span class="card-title" aria-hidden="true">Sécurité d'un événement</span>
			</label>
		</div>
		<div class="form-field">
			<label for="choise4" class="card card-questions">
				<input type="radio" autocomplete="off" name="choise" value="Autres questions ou suggestions" id="choise4" class="radio" />
				<span class="sr-only">Autres questions ou suggestions</span>
				<span class="card-title" aria-hidden="true">Autres questions ou suggestions</span>
			</label>
		</div>
	</fieldset>

	<!-- 1rst section - swimming lessons -->
	<fieldset class="form-section" id="swimming-lessons">
		<legend>Contact pour leçons de natation à domicile</legend>
		<div class="form-field col-100">
			<label for="name">Nom d'un des parents</label>
			<input type="text" name="name" />
		</div>
		<div class="form-field">
			<label for="tel">Numéro de téléphone</label>
			<input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" />
		</div>
		<div class="form-field">
			<label for="email">Adresse mail</label>
			<input type="email" name="email" />
		</div>
		<div class="form-field col-100">
			<label for="location">Où est-ce que l'on nage ?</label>
			<input type="text" name="location" />
			<small>Adresse et code postal de la piscine</small>
		</div>
		<div class="form-field col-100">
			<label for="dates">Quand vodriez-vous réserver un cours ?</label>
			<textarea name="dates" rows="3"></textarea>
			<small>Veuillez nous fournir plusieurs dates et heures</small>
		</div>

		<p class="col-100">Nous ne garantissons pas la réservation de vos créneaux mais nous ferons de notre mieux pour vous répondre favorablement.</p>

		<div class="col-100">
			<h3>Aide à l'évaluation du niveau du baigneur</h3>
			<ul>
				<li><span>Mini-Baigneur</span> : Débutant ( J'ai les brassards et je ne mets pas la tête dans l’eau )</li>
				<li><span>Petit-Baigneur</span> : Sécurité aquatique ( J'ai les brassards, je saute et je mets la tête dans l’eau )</li>
			</ul>
		</div>
	</fieldset>

	<!-- 2nd section - aquaversary -->
	<fieldset class="form-section" id="aquaversary">
		<legend>Contact pour un Aquaversaire</legend>
		<div class="form-field">
			<label for="name">Nom</label>
			<input type="text" name="name" />
		</div>
		<div class="form-field">
			<label for="firstname">Prénom</label>
			<input type="text" name="firstname" />
		</div>
		<div class="form-field">
			<label for="tel">Numéro de téléphone</label>
			<input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" />
		</div>
		<div class="form-field">
			<label for="email">Adresse mail</label>
			<input type="email" name="email" />
		</div>
		<div class="form-field col-100">
			<label for="info">Où ? Quand ? Et combien de baigneurs</label>
			<textarea name="info" rows="3"></textarea>
			<small>Exemple: Je souhaite organiser un aquaversaire à Aix le 01/01/23 pour 10 enfants...</small>
		</div>
	</fieldset>

	<!-- 3rd section - events -->
	<fieldset class="form-section" id="events">
		<legend>Contact pour de la surveillance</legend>
		<div class="form-field">
			<label for="name">Nom</label>
			<input type="text" name="name" />
		</div>
		<div class="form-field">
			<label for="firstname">Prénom</label>
			<input type="text" name="firstname" />
		</div>
		<div class="form-field">
			<label for="tel">Numéro de téléphone</label>
			<input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" />
		</div>
		<div class="form-field">
			<label for="email">Adresse mail</label>
			<input type="email" name="email" />
		</div>
		<div class="form-field col-100">
			<label for="info">Où ? Quand ? Et combien de personnes ? Quel type d'événement ?</label>
			<textarea name="info" rows="3"></textarea>
			<small>Exemple: Je souhaite sécuriser un mariage à Aix le 01/01/23 pour 50 personnes...</small>
		</div>
	</fieldset>

	<!-- 4th section - questions -->
	<fieldset class="form-section" id="questions">
		<legend>Autres questions et suggestions</legend>

		<div class="form-field">
			<label for="name">Nom</label>
			<input type="text" name="name" />
		</div>
		<div class="form-field">
			<label for="firstname">Prénom</label>
			<input type="text" name="firstname" />
		</div>
		<div class="form-field">
			<label for="tel">Numéro de téléphone</label>
			<input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" />
		</div>
		<div class="form-field">
			<label for="email">Adresse mail</label>
			<input type="email" name="email" />
		</div>
		<div class="form-field col-100">
			<label for="info">Message</label>
			<textarea name="info" rows="3"></textarea>
		</div>
	</fieldset>

	<!-- RGDP -->
	<fieldset class="form-section" id="rgpd">
		<div class="form-field col-100">
			<input type="checkbox" name="rgpd" id="rgpd" required />
			<label for="rgpd" class="rgpd-label"
				>En soumettant ce formulaire, j'accepte que les informations saisies dans ce formulaire soient utilisées pour permettre de me recontacter.
			</label>
		</div>

		<!-- submit button -->
		<Buttons type="submit" class="btn btn-regular">Envoyer</Buttons>
	</fieldset>
</form>

<style lang="scss">
	form {
		//form variables
		--card-line-height: 1.2em;
		--card-padding: var(--space-md);
		--card-radius: 20px;
		--color-gray: #e2ebf6;
		--color-dark-gray: #c4d1e1;
		--radio-border-width: 2px;
		--radio-size: 1.5em;
		--form-gap: 1.5rem;

		max-width: 800px;
		margin: auto;
		display: grid;
		grid-gap: var(--form-gap);
		padding-block: 2rem;

		label {
			display: block;
		}
		label:not(.card, .rgpd-label) {
			padding-left: var(--space-xs);
			font-size: 1rem;
			font-weight: 600;
			color: var(--color-secondary);
		}
		small {
			color: hsla(var(--link-color-black-hsl), 0.5);
			padding-left: var(--space-xs);
		}

		fieldset {
			padding: var(--form-gap);
			display: grid;
			grid-template-columns: 1fr;
			grid-gap: var(--form-gap);
			border: none;
			border-radius: 20px;

			@media screen and (min-width: 576px) {
				display: grid;
				grid-template-columns: repeat(2, minmax(0, 1fr));
			}

			& > legend {
				padding-inline: 1rem;
				font-family: var(--ff-pacifico);
				color: var(--color-primary);
				font-size: var(--fs-lg);
			}
			& > .form-field {
				margin: 0;
				display: flex;
				gap: 0.3rem;
				flex-direction: column;
				grid-column: 1 / 3;

				@media screen and (min-width: 600px) {
					grid-column: unset;
				}
			}
			*.col-100 {
				grid-column: 1 / 3;
			}
			input:not([name="choise"]),
			textarea {
				background-color: var(--color-white);
				border-radius: 20px;
				padding: 0.5rem;
				border: var(--radio-border-width) solid var(--color-gray);

				&:hover {
					border-color: var(--color-dark-gray);
				}
				&:focus {
					outline: 2px solid var(--color-primary);
					box-shadow: 1px 1px 8px 1px hsla(var(--link-color-primary-hsl), 0.5);
				}
			}
		}
		.card {
			background-color: var(--color-white);
			border-radius: var(--card-radius);
			position: relative;
			overflow: hidden;

			&::before {
				content: "";
				position: absolute;
				width: 200%;
				height: 200%;
				z-index: 1;
				top: 50%;
				left: -1rem;
				transform: translateY(-50%);
				opacity: 0.05;
				background-repeat: no-repeat;
				background-position: left;
				background-size: contain;
			}

			&:hover {
				box-shadow: 0 10px 15px -3px hsla(var(--link-color-primary-hsl), 0.3), 0 4px 6px -4px hsla(var(--link-color-primary-hsl), 0.3);
			}

			&.card-swimming {
				&::before {
					background-image: url("/images/icons/swimmer.svg");
				}
			}
			&.card-aquaversary {
				&::before {
					background-image: url("/images/icons/aquaversaire.svg");
				}
			}
			&.card-events {
				&::before {
					background-image: url("/images/icons/event.svg");
				}
			}
			&.card-questions {
				&::before {
					background-image: url("/images/icons/comment-smile.svg");
				}
			}
		}

		.radio {
			font-size: inherit;
			margin: 0;
			position: absolute;
			right: calc(var(--card-padding) + var(--radio-border-width));
			top: calc(var(--card-padding) + var(--radio-border-width));
		}

		@supports (-webkit-appearance: none) or (-moz-appearance: none) {
			.radio {
				-webkit-appearance: none;
				-moz-appearance: none;
				background: #fff;
				border: var(--radio-border-width) solid var(--color-gray);
				border-radius: 50%;
				cursor: pointer;
				height: var(--radio-size);
				outline: none;
				transition: background 0.2s ease-out, border-color 0.2s ease-out;
				width: var(--radio-size);

				&::after {
					border: var(--radio-border-width) solid #fff;
					border-top: 0;
					border-left: 0;
					content: "";
					display: block;
					height: 0.75rem;
					left: 25%;
					position: absolute;
					top: 50%;
					transform: rotate(45deg) translate(-50%, -50%);
					width: 0.375rem;
				}

				&:checked {
					background: var(--color-primary);
					border-color: var(--color-primary);
				}
			}

			.card:hover .radio {
				border-color: var(--color-dark-gray);

				&:checked {
					border-color: var(--color-primary);
				}
			}
		}

		.card-title {
			border: var(--radio-border-width) solid var(--color-gray);
			border-radius: var(--card-radius);
			cursor: pointer;
			display: flex;
			flex-direction: column;
			padding-block: var(--card-padding);
			padding-inline: var(--card-padding) 4rem;

			transition: border-color 0.2s ease-out;
		}

		.card:hover .card-title {
			border-color: var(--color-dark-gray);
		}

		.radio:checked ~ .card-title {
			border-color: var(--color-primary);
		}

		.radio:focus ~ .card-title {
			box-shadow: 0 0 0 2px var(--color-dark-gray);
		}

		.radio:disabled ~ .card-title {
			color: var(--color-dark-gray);
			// cursor: default;
		}

		.card:hover .radio:disabled ~ .card-title {
			border-color: var(--color-gray);
			box-shadow: none;
		}

		.card:hover .radio:disabled {
			border-color: var(--color-gray);
		}
	}
</style>

<script is:inline>
	// Get all elements with the class name "form-section"
	const formSections = document.getElementsByClassName("form-section");

	// Loop through each of the form sections
	for (const formSection of formSections) {
		// Hide each form section exects swimming sessons which is the default one
		// if (formSection.id !== "swimming-lessons") {
		formSection.style.display = "none";
		// }
	}
	// 1. Select all radio buttons
	const radioButtons = document.querySelectorAll("input[name='choise']");

	// 2. Add an event listener to each radio button
	radioButtons.forEach(button => {
		button.addEventListener("change", event => {
			const swimmingSection = document.getElementById("swimming-lessons");
			const aquaversarySection = document.getElementById("aquaversary");
			const eventsSection = document.getElementById("events");
			const questionsSection = document.getElementById("questions");
			const rgpd = document.getElementById("rgpd");

			// 3. Display the corresponding form
			switch (event.target.value) {
				case "Leçons de natation":
					swimmingSection.style.display = "grid";
					aquaversarySection.style.display = "none";
					eventsSection.style.display = "none";
					questionsSection.style.display = "none";
					rgpd.style.display = "block";
					break;
				case "Organisation d'un aquaversaire":
					swimmingSection.style.display = "none";
					aquaversarySection.style.display = "grid";
					eventsSection.style.display = "none";
					questionsSection.style.display = "none";
					rgpd.style.display = "block";

					break;
				case "Sécuriter d'un événement":
					swimmingSection.style.display = "none";
					aquaversarySection.style.display = "none";
					eventsSection.style.display = "grid";
					questionsSection.style.display = "none";
					rgpd.style.display = "block";

					break;
				case "Autres questions ou suggestions":
					swimmingSection.style.display = "none";
					aquaversarySection.style.display = "none";
					eventsSection.style.display = "none";
					questionsSection.style.display = "grid";
					rgpd.style.display = "block";

					break;
			}
		});
	});
</script>
